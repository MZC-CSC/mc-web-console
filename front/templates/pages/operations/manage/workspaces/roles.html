<div class="page-body">
  <div class="page">
    <div class="page-wrapper">
      <div class="page-body">
        <div class="container-xl">
          <!-- List -->
          <div class="row row-cards">
            <!-- table area-->
            <div class="col-md-12">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">List of Roles</h3>
                  <div class="card-actions btn-actions">
                    <a
                      href="#create_role"
                      class="btn btn-primary"
                      data-bs-toggle="collapse"
                      data-bs-target="#create-mode-cards"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="icon"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        stroke-width="2"
                        stroke="currentColor"
                        fill="none"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path
                          stroke="none"
                          d="M0 0h24v24H0z"
                          fill="none"
                        ></path>
                        <path d="M12 5l0 14"></path>
                        <path d="M5 12l14 0"></path>
                      </svg>
                      Add
                    </a>
                  </div>
                </div>

                <div
                  class="card-table table-responsive"
                  style="max-height: 400px; overflow: hidden"
                >
                  <div id="roles-table" class="roles-table-container"></div>
                </div>
              </div>
            </div>
            <!-- table area end -->
          </div>

          <!-- == V I E W == 모드 카드들 -->
          <div id="view-mode-cards" class="collapse bg-secondary-lt">
            <!-- 배경 적용 카드 -->
            <div class="card col-md-11 mx-auto">
              <!-- Role Detail 카드 (신규) -->
              <div class="card" id="role-detail-card">
                <div class="card-header">
                  <h3 class="card-title">Role Detail</h3>
                </div>
                <div class="card-body">
                  <!-- TODO: Role 상세 정보 필드들 -->
                  <p>
                    <strong>Name:</strong>
                    <span id="role-detail-name-view"></span>
                  </p>
                  <p>
                    <strong>Description:</strong>
                    <span id="role-detail-desc-view"></span>
                  </p>
                </div>
              </div>

              <!-- Platform (기존, 래퍼 안으로 이동) -->
              <div class="card" id="platform-menu">
                <div class="card-header">
                  <h3 class="card-title">
                    Platform
                    <span id="platform-menu-status" class="ms-2" style="display: none;">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" style="color: #206bc4;">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M5 12l5 5l10 -10"></path>
                      </svg>
                      <small class="text-muted">Menu permissions available</small>
                    </span>
                  </h3>
                </div>
                <div class="card-body collapse" id="platform-menu-body">
                  <div
                    id="platform-menu-tree"
                    style="
                      background-color: #f8f9fa;
                      border: 1px solid #e9ecef;
                      border-radius: 4px;
                      padding: 10px;
                      max-height: 300px;
                      overflow-y: auto;
                    "
                  ></div>
                </div>
              </div>

              <!-- Workspace (기존, 래퍼 안으로 이동) -->
              <div class="card" id="workspace-menu">
                <div class="card-header">
                  <h3 class="card-title">Workspace</h3>
                </div>
                <div class="card-body collapse" id="workspace-menu-body">
                  <div class="row align-items-center">
                    <div class="col-auto me-3">
                      <label class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="workspace-toggle-view" disabled>
                        <span class="form-check-label"></span>
                      </label>
                    </div>
                    <div class="col">
                      <div class="form-label text-primary">Workspace Access</div>
                      <div class="text-muted">Enable workspace functionality for this role</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- CSP Role Mapping (기존, 래퍼 안으로 이동) -->
              <div class="card" id="csp-role-mapping">
                <div class="card-header">
                  <h3 class="card-title">
                    CSP Role Mapping
                    <span id="csp-role-mapping-rolename" class="ms-2" style="display: none; color: #87CEEB; font-weight: normal;">
                      [<span id="csp-role-mapping-rolename-text"></span>]
                    </span>
                  </h3>
                </div>
                <div class="card-body collapse" id="csp-role-mapping-body">
                  <div id="csp-role-mapping-table"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- == C R E A T E == 모드 카드들 -->
          <div id="create-mode-cards" class="collapse bg-secondary-lt">
            <!-- 배경 적용 카드 -->
            <div class="card col-md-11 mx-auto">
              <!-- Create New Role Card -->
              <div class="card" id="create_role">
                <div class="card-header">
                  <h3 class="card-title">Create New Role</h3>
                </div>
                <div class="card-body">
                  <form>
                    <div class="mb-3">
                      <label class="form-label required">Role Name</label>
                      <input
                        type="text"
                        class="form-control"
                        id="role-name-input"
                        name="role-name"
                        placeholder="Enter role name"
                        required
                      />
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Description</label>
                      <textarea
                        class="form-control"
                        id="role-description-input"
                        name="role-description"
                        placeholder="Enter role description"
                        rows="3"
                      ></textarea>
                    </div>
                  </form>
                </div>
              </div>

              <!-- Platform (Create) -->
              <div class="card" id="platform-menu-create">
                <div class="card-header">
                  <h3 class="card-title">Platform</h3>
                </div>
                <div class="card-body">
                  <div
                    id="platform-menu-create-tree"
                    style="
                      background-color: #f8f9fa;
                      border: 1px solid #e9ecef;
                      border-radius: 4px;
                      padding: 10px;
                      max-height: 300px;
                      overflow-y: auto;
                    "
                  ></div>
                  <!-- Create용 트리 -->
                </div>
              </div>

              <!-- Workspace (Create) -->
              <div class="card" id="workspace-menu-create">
                <div class="card-header">
                  <h3 class="card-title">Workspace</h3>
                </div>
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="col-auto me-3">
                      <label class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="workspace-toggle-create">
                        <span class="form-check-label"></span>
                      </label>
                    </div>
                    <div class="col">
                      <div class="form-label text-primary">Workspace Access</div>
                      <div class="text-muted">Enable workspace functionality for this role</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- CSP Role Mapping (Create) -->
              <div class="card" id="csp-role-mapping-create">
                <div class="card-header">
                  <h3 class="card-title">CSP Role Mapping</h3>
                </div>
                <div class="card-body">
                  <form id="csp-role-mapping-form">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="mb-3">
                          <label class="form-label required">CSP Provider</label>
                          <select class="form-select" id="csp-provider-select" name="csp-provider" required>
                            <option value="">Select CSP Provider</option>
                            <option value="aws">AWS</option>
                            <option value="gcp">GCP</option>
                            <option value="azure">Azure</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="mb-3">
                          <label class="form-label required">Protocol</label>
                          <select class="form-select" id="csp-protocol-select" name="csp-protocol" required>
                            <option value="">Select Protocol</option>
                            <option value="oidc">OIDC</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>

              <!-- Save/Cancel 버튼 -->
              <div class="d-flex justify-content-end mt-3">
                <button class="btn me-2" id="cancel-create-role-btn">
                  Cancel
                </button>
                <button class="btn btn-primary" id="save-create-role-btn">
                  Save Role
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%= javascriptTag("common/api/services/roles_api.js") %> <%=
javascriptTag("pages/operation/workspace/roles.js") %>
